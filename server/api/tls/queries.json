{
  "TlsRequests": {
    "description": "Number of requests per TLS version",
    "sql": [
      "SELECT tls as id, COUNT(tls) as value",
      "FROM",
      "(SELECT JSON_EXTRACT(payload, '$._securityDetails.protocol') as tls",
      "FROM",
      "httparchive.smaller_sample_requests",
      "where url like (\"https%\"))",
      "where tls is not null",
      "GROUP BY tls"
    ],
    "tableIndex": "4",
    "suggestedVisualizations": ["Pie chart"],
    "mockResult": [
      {
        "id": "\"TLS 1.2\"",
        "value": 12
      },
      {
        "id": "\"TLS 1.3\"",
        "value": 13
      }
    ]
  },
  "SignatureAlgorithm": {
    "description": "",
    "sql": [
      "SELECT JSON_EXTRACT(payload, '$._securityDetails.signedCertificateTimestampList[0].signatureAlgorithm')",
      "as signature, count(*)",
      "FROM `httparchive.sample_data.requests_desktop_10k`",
      "group by signature;"
    ]
  },
  "KeyExchange": {
    "description": "Key exchange algorithm usage",
    "sql": [
      "SELECT trim(JSON_EXTRACT(payload, '$._securityDetails.keyExchange'), \"\\\"\") as id, count(*) as value",
      "FROM ",
      "httparchive.sample_data.requests_desktop_10k",
      "group by id",
      "having id is not null"
    ],
    "tableIndex": "2",
    "mockResult": [
      {
        "id": "",
        "value": 74131
      },
      {
        "id": "ECDHE_RSA",
        "value": 51109
      },
      {
        "id": "ECDHE_ECDSA",
        "value": 3272
      },
      {
        "id": "RSA",
        "value": 1825
      }
    ]
  }
}
