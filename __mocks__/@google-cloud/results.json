{
  "SELECT tls as id, COUNT(tls) as value FROM (SELECT JSON_EXTRACT(payload, '$._securityDetails.protocol') as tls FROM httparchive.smaller_sample_requests where url like (\"https%\")) where tls is not null GROUP BY tls": {
    "description": "Number of requests per TLS version",
    "result": [
      {
        "id": "\"TLS 1.2\"",
        "value": 12
      },
      {
        "id": "\"TLS 1.3\"",
        "value": 13
      }
    ],
    "suggestedVisualizations": ["Pie chart"],
    "tableUsed": "httparchive.smaller_sample_requests"
  },
  "SELECT trim(JSON_EXTRACT(payload, '$._securityDetails.keyExchange'), \"\\\"\") as id, count(*) as value FROM  httparchive.sample_data.requests_desktop_10k group by id having id is not null": {
    "description": "Key exchange algorithm usage",
    "result": [
      {
        "id": "",
        "value": 74131
      },
      {
        "id": "ECDHE_RSA",
        "value": 51109
      },
      {
        "id": "ECDHE_ECDSA",
        "value": 3272
      },
      {
        "id": "RSA",
        "value": 1825
      }
    ]
  },
  "SELECT substr(mimeType, 1, strpos(mimeType, \"/\")-1) as id, count(*) value, count(distinct p.pageid) as pages FROM httparchive.sample_data.summary_requests_desktop_10k r INNER JOIN httparchive.sample_data.summary_pages_desktop_10k p ON r.pageid=p.pageid WHERE r.url NOT LIKE (\"https%\") AND p.url LIKE (\"https%\") and char_length(mimeType)>0 GROUP by id HAVING value > 1": {
    "result": [
      {
        "id": "text",
        "value": 1268,
        "pages": 354
      },
      {
        "id": "font",
        "value": 247,
        "pages": 75
      },
      {
        "id": "image",
        "value": 2250,
        "pages": 243
      },
      {
        "id": "application",
        "value": 1889,
        "pages": 912
      }
    ]
  }
}
